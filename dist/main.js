(()=>{"use strict";const e=function(){let e=[],t=["personal","work"];function n(e){e.sort(((e,t)=>e.dueDate>t.dueDate?1:-1))}return{addItem:function(t){e.push(t),n(e),console.log(e)},itemFactory:(e,t,n,d,o)=>({priority:e,title:t,description:n,dueDate:d,category:o}),editItem:function(t,n,d,o,l,i){e[t].priority=n,e[t].title=d,e[t].description=o,e[t].dueDate=l,e[t].category=i,console.log(e)},deleteItem:function(t){e.splice(t,1),n(e)},weeklyFilter:function(){const t=new Date;let n=t.toISOString().slice(0,10);t.setDate(t.getDate()+7);let d=t.toISOString().slice(0,10),o=[];for(let t=0;t<e.length;t++)e[t].dueDate>=n&&e[t].dueDate<=d&&o.push(e[t]);return o},dailyFilter:function(){let t=(new Date).toISOString().slice(0,10),n=[];for(let d=0;d<e.length;d++)e[d].dueDate==t&&n.push(e[d]);return n},categoryFilter:function(t){let n=[];for(let d=0;d<e.length;d++)e[d].category==t&&n.push(e[d]);return n},itemArray:e,categories:t,addCategory:function(e){t.push(e)},editCategory:function(n,d){if(console.log("turning "+n+" into "+d),console.log(t.includes(d)),0==t.includes(d)){for(let t=0;t<e.length;t++)e[t].category===n&&(e[t].category=d);for(let e=0;e<t.length;e++)t[e]===n&&(t[e]=d)}}}}(),t=document.getElementById("add-item"),n=document.getElementById("add-cat"),d=document.getElementById("modal-close"),o=document.getElementById("edit-close"),l=document.getElementById("category-close"),i=document.getElementById("edit-category-close"),a=document.getElementById("main-category");document.getElementById("main-text-category");let c=function(){function e(){u(),r(),document.querySelector(".modal").style.display="flex"}function c(){document.querySelector(".modal").style.display="none"}function r(){document.querySelector(".edit-modal").style.display="none"}function u(){document.querySelector(".category-modal").style.display="none"}function m(){document.querySelector(".edit-category-modal").style.display="none"}function s(){c(),r(),document.querySelector(".category-modal").style.display="flex"}return"Add new category..."===a.value&&console.log("Wow!"),t.addEventListener("click",(function(){e()})),d.addEventListener("click",(function(){c()})),o.addEventListener("click",(function(){r()})),i.addEventListener("click",(function(){m()})),n.addEventListener("click",(function(){s()})),l.addEventListener("click",(function(){u()})),y(),{showModal:e,hideModal:c,showEditModal:function(){c(),u(),document.querySelector(".edit-modal").style.display="flex"},hideEditModal:r,showCategoryModal:s,hideCategoryModal:u,showEditCategoryModal:function(){document.querySelector(".edit-category-modal").style.display="flex"},hideEditCategoryModal:m}}();function r(e){for(;document.querySelector("tbody").childNodes.length>1;)document.querySelector("tbody").removeChild(document.querySelector("tbody").lastChild);for(let t=0;t<e.length;t++){let n=e[t].priority,d=e[t].title,o=e[t].description,l=e[t].dueDate,i=e[t].category,a=document.createElement("tr");a.setAttribute("data-set",t);let c=document.createElement("td");c.innerHTML='<input type="checkbox" value="test" checked="unchecked">',a.appendChild(c);let r=document.createElement("td");r.innerHTML="<p class="+n+">⚫</p>",a.appendChild(r);let u=document.createElement("td");u.innerHTML=d,a.appendChild(u);let m=document.createElement("td");m.innerHTML=o,a.appendChild(m);let y=document.createElement("td");y.innerHTML=l,a.appendChild(y);let s=document.createElement("td");s.innerHTML=i,a.appendChild(s);let g=document.createElement("td");g.innerHTML='<button class="edit-btn">✎</button>',a.appendChild(g),document.querySelector("tbody").appendChild(a)}}function u(e){document.getElementById("table-title").innerHTML=e}function m(){document.getElementById("edit-form").reset(),document.getElementById("modal-form").reset(),document.getElementById("category-form").reset()}function y(){const t=document.getElementById("category-list"),n=document.querySelector("#main-category"),d=document.querySelector("#edit-category");t.innerHTML="",n.innerHTML="",d.innerHTML="";let o=document.createElement("option");o.value="add",o.id="last-option",o.innerText="Add new category...",n.appendChild(o);let l=document.createElement("option");l.value="add",l.id="last-option",l.innerText="Add new category...",d.appendChild(l);for(let i=0;i<e.categories.length;i++){let a=e.categories[i],c=document.createElement("li");c.innerHTML='<a id="'+a+'"href="#" onclick="return false;">'+a+'</a><button class="remove-cat-btn">✎</button>',t.appendChild(c);let r=document.createElement("option");r.value=a,r.innerHTML=a;let u=r.cloneNode(!0);n.insertBefore(r,o),d.insertBefore(u,l)}document.getElementById("main-text-category").style.display="none",document.getElementById("edit-text-category").style.display="none"}const s=document.getElementById("modal-submit");let g,E,f,p="viewAll";function h(){p="today",r(e.dailyFilter()),u("Viewing Today's Tasks")}function v(){p="thisWeek",r(e.weeklyFilter()),u("Viewing This Week's Tasks")}function I(t){let n=e.categoryFilter(t);u("Viewing all "+t+" tasks"),r(n)}s.addEventListener("click",(function(){let t=document.getElementById("priority").value,n=document.getElementById("title").value,d=document.getElementById("description").value,o=document.getElementById("due-date").value,l=document.getElementById("main-category").value;switch("add"===l&&(l=document.getElementById("main-text-category").value.toLowerCase(),e.addCategory(l),y()),e.addItem(e.itemFactory(t,n,d,o,l)),c.hideModal(),p){case"viewAll":r(e.itemArray);break;case"today":h();break;case"thisWeek":v()}"viewAll"!=p&&"today"!=p&&"thisWeek"!=p&&I(p),m()})),document.addEventListener("click",(function(t){if(t.target&&"edit-btn"===t.target.className)g=t.target.parentElement.parentElement.getAttribute("data-set"),function(t){c.showEditModal();let n=e.itemArray[t].priority;document.getElementById("edit-priority").value=n;let d=e.itemArray[t].title;document.getElementById("edit-title").value=d;let o=e.itemArray[t].description;document.getElementById("edit-description").value=o;let l=e.itemArray[t].dueDate;document.getElementById("edit-date").value=l;let i=e.itemArray[t].category;document.getElementById("edit-category").value=i,console.log(i),console.log(e.itemArray[t])}(g);else if(e.categories.includes(t.target.innerText.toLowerCase())&&"A"==t.target.tagName){let e=t.target.innerText.toLowerCase();p=e,I(e)}else if(t.target&&"remove-cat-btn"===t.target.className){let e=t.target.parentElement.firstChild.id;n=e,c.showEditCategoryModal(),document.getElementById("edit-category-sidebar").value=n,E=e}var n})),document.getElementById("edit-submit").addEventListener("click",(function(){let t=document.getElementById("edit-priority").value,n=document.getElementById("edit-title").value,d=document.getElementById("edit-description").value,o=document.getElementById("edit-date").value,l=document.getElementById("edit-category").value;switch("add"===l&&(l=document.getElementById("edit-text-category").value.toLowerCase(),e.addCategory(l),y()),e.editItem(g,t,n,d,o,l),c.hideEditModal(),p){case"viewAll":r(e.itemArray);break;case"today":h();break;case"thisWeek":v()}"viewAll"!=p&&"today"!=p&&"thisWeek"!=p&&I(p),m()})),document.getElementById("edit-category-submit").addEventListener("click",(function(){switch(f=document.getElementById("edit-category-sidebar").value,e.editCategory(E,f),updateCategorySidebar(),c.hideEditCategoryModal(),p){case"viewAll":r(e.itemArray);break;case"today":h();break;case"thisWeek":v()}"viewAll"!=p&&"today"!=p&&"thisWeek"!=p&&I(p),m()})),document.getElementById("delete-item").addEventListener("click",(function(){e.deleteItem(g),c.hideEditModal(),r(e.itemArray)})),document.getElementById("view-all").addEventListener("click",(function(){u("Viewing All Tasks"),p="viewAll",r(e.itemArray)})),document.getElementById("today").addEventListener("click",(function(){h()})),document.getElementById("this-week").addEventListener("click",(function(){v()})),document.getElementById("category-submit").addEventListener("click",(function(){const t=document.getElementById("category-category").value.toLowerCase();e.addCategory(t),y(),c.hideCategoryModal(),m()}))})();